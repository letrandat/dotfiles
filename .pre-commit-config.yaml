# Pre-commit configuration for dotfiles
# Auto-generated by Claude Code
# Docs: https://pre-commit.com/

# Install both pre-commit and prepare-commit-msg hooks by default
# Allows commit message processing hooks to work automatically
default_install_hook_types: [pre-commit, prepare-commit-msg]

# UNIVERSAL HOOKS - Recommended for ALL projects
# These hooks are language-agnostic and catch common issues

repos:
  # === Universal Quality Hooks ===
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      # File quality & formatting
      - id: trailing-whitespace
        name: Remove trailing whitespace
        description: Removes trailing spaces from all files

      - id: end-of-file-fixer
        name: Fix end of files
        description: Ensures files end with exactly one newline

      - id: mixed-line-ending
        name: Standardize line endings
        description: Ensures consistent line endings (LF)
        args: ["--fix=lf"]

      # File size & safety
      - id: check-added-large-files
        name: Check for large files
        description: Prevents committing files larger than 500KB
        args: ["--maxkb=500"]

      # Syntax validation (works for all projects)
      - id: check-yaml
        name: Validate YAML syntax
        description: Checks YAML files are valid

      - id: check-json
        name: Validate JSON syntax
        description: Checks JSON files are valid

      - id: check-toml
        name: Validate TOML syntax
        description: Checks TOML files are valid

      # Git hygiene
      - id: check-merge-conflict
        name: Check for merge conflicts
        description: Detects unresolved merge conflict markers

      - id: detect-private-key
        name: Detect private keys
        description: Prevents committing SSH keys, AWS credentials

  # === Markdown ===
  - repo: https://github.com/DavidAnson/markdownlint-cli2
    rev: v0.20.0
    hooks:
      - id: markdownlint-cli2
        name: Markdownlint
        description: Markdown style and syntax checker
        args: ['--fix']

  # === Shell Scripts (Bash/Zsh) ===
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.11.0.1
    hooks:
      - id: shellcheck
        name: ShellCheck
        description: Shell script static analysis

  # === Lua (Neovim configs) ===
  - repo: https://github.com/JohnnyMorganz/StyLua
    rev: v2.3.1
    hooks:
      - id: stylua
        name: StyLua
        description: Lua code formatter

  # === Python ===
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.10
    hooks:
      - id: ruff
        name: Ruff linter
        description: Fast Python linter (replaces flake8, isort, etc.)
        args: ['--fix']

      - id: ruff-format
        name: Ruff formatter
        description: Fast Python formatter (replaces black)

  # === JavaScript / TypeScript ===
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v10.0.0-beta.0
    hooks:
      - id: eslint
        name: ESLint
        description: JavaScript/TypeScript linter
        args: ['--fix']
        additional_dependencies:
          - eslint@9.0.0
          - '@typescript-eslint/parser@7.0.0'
          - '@typescript-eslint/eslint-plugin@7.0.0'

  # === Go ===
  - repo: https://github.com/golangci/golangci-lint
    rev: v2.7.2
    hooks:
      - id: golangci-lint
        name: golangci-lint
        description: Fast Go linters runner

# ============================================================
# SETUP INSTRUCTIONS
# ============================================================
#
# 1. Install pre-commit:
#    macOS:  brew install pre-commit
#    Linux:  pip3 install pre-commit
#
# 2. Install git hooks (both pre-commit and prepare-commit-msg):
#    pre-commit install
#
# 3. Run hooks manually:
#    pre-commit run                    # On staged files only (recommended)
#    pre-commit run --files <path>     # On specific files
#
#    ⚠️  AVOID: pre-commit run --all-files
#    Running on all files causes diff pollution and merge conflicts.
#    Only use --all-files for repository-wide cleanup when needed.
#
# 4. Update hook versions:
#    pre-commit autoupdate
#
# 5. Skip hooks temporarily (if needed):
#    SKIP=hook-name git commit
#    git commit --no-verify            # Skip all hooks
#
# Docs: https://pre-commit.com/
# Hook registry: https://pre-commit.com/hooks.html
